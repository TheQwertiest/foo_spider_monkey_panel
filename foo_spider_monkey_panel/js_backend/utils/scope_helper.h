#pragma once

#include <js_backend/utils/js_error_helper.h>

struct JSContext;

namespace mozjs
{

class JsAutoRealmWithErrorReport
{
public:
    [[nodiscard]] JsAutoRealmWithErrorReport( JSContext* cx, JS::HandleObject global )
        : ac_( cx, global )
        , are_( cx )
    {
    }

    JsAutoRealmWithErrorReport( const JsAutoRealmWithErrorReport& ) = delete;
    JsAutoRealmWithErrorReport& operator=( const JsAutoRealmWithErrorReport& ) = delete;

    void DisableReport()
    {
        are_.Disable();
    }

private:
    JSAutoRealm ac_;
    mozjs::error::AutoReportError are_;
};

} // namespace mozjs
