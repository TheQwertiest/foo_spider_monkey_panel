#include <stdafx.h>

#include "dom_codes.h"

#include <qwr/algorithm.h>

#include <unordered_map>

namespace
{

const std::unordered_map<uint32_t, qwr::u8string> kScanCodeToValue{
    { 0x0001, "Escape" },
    { 0x0002, "Digit1" },
    { 0x0003, "Digit2" },
    { 0x0004, "Digit3" },
    { 0x0005, "Digit4" },
    { 0x0006, "Digit5" },
    { 0x0007, "Digit6" },
    { 0x0008, "Digit7" },
    { 0x0009, "Digit8" },
    { 0x000a, "Digit9" },
    { 0x000b, "Digit0" },
    { 0x000c, "Minus" },
    { 0x000d, "Equal" },
    { 0x000e, "Backspace" },
    { 0x000f, "Tab" },
    { 0x0010, "KeyQ" },
    { 0x0011, "KeyW" },
    { 0x0012, "KeyE" },
    { 0x0013, "KeyR" },
    { 0x0014, "KeyT" },
    { 0x0015, "KeyY" },
    { 0x0016, "KeyU" },
    { 0x0017, "KeyI" },
    { 0x0018, "KeyO" },
    { 0x0019, "KeyP" },
    { 0x001a, "BracketLeft" },
    { 0x001b, "BracketRight" },
    { 0x001c, "Enter" },
    { 0x001d, "ControlLeft" },
    { 0x001e, "KeyA" },
    { 0x001f, "KeyS" },
    { 0x0020, "KeyD" },
    { 0x0021, "KeyF" },
    { 0x0022, "KeyG" },
    { 0x0023, "KeyH" },
    { 0x0024, "KeyJ" },
    { 0x0025, "KeyK" },
    { 0x0026, "KeyL" },
    { 0x0027, "Semicolon" },
    { 0x0028, "Quote" },
    { 0x0029, "Backquote" },
    { 0x002a, "ShiftLeft" },
    { 0x002b, "Backslash" },
    { 0x002c, "KeyZ" },
    { 0x002d, "KeyX" },
    { 0x002e, "KeyC" },
    { 0x002f, "KeyV" },
    { 0x0030, "KeyB" },
    { 0x0031, "KeyN" },
    { 0x0032, "KeyM" },
    { 0x0033, "Comma" },
    { 0x0034, "Period" },
    { 0x0035, "Slash" },
    { 0x0036, "ShiftRight" },
    { 0x0037, "NumpadMultiply" },
    { 0x0038, "AltLeft" },
    { 0x0039, "Space" },
    { 0x003a, "CapsLock" },
    { 0x003b, "F1" },
    { 0x003c, "F2" },
    { 0x003d, "F3" },
    { 0x003e, "F4" },
    { 0x003f, "F5" },
    { 0x0040, "F6" },
    { 0x0041, "F7" },
    { 0x0042, "F8" },
    { 0x0043, "F9" },
    { 0x0044, "F10" },
    { 0x0045, "Pause" },
    { 0x0046, "ScrollLock" },
    { 0x0047, "Numpad7" },
    { 0x0048, "Numpad8" },
    { 0x0049, "Numpad9" },
    { 0x004a, "NumpadSubtract" },
    { 0x004b, "Numpad4" },
    { 0x004c, "Numpad5" },
    { 0x004d, "Numpad6" },
    { 0x004e, "NumpadAdd" },
    { 0x004f, "Numpad1" },
    { 0x0050, "Numpad2" },
    { 0x0051, "Numpad3" },
    { 0x0052, "Numpad0" },
    { 0x0053, "NumpadDecimal" },
    { 0x0056, "IntlBackslash" },
    { 0x0057, "F11" },
    { 0x0058, "F12" },
    { 0x0059, "NumpadEqual" },
    { 0x0064, "F13" },
    { 0x0065, "F14" },
    { 0x0066, "F15" },
    { 0x0067, "F16" },
    { 0x0068, "F17" },
    { 0x0069, "F18" },
    { 0x006a, "F19" },
    { 0x006b, "F20" },
    { 0x006c, "F21" },
    { 0x006d, "F22" },
    { 0x006e, "F23" },
    { 0x0070, "KanaMode" },
    { 0x0071, "Lang2" },
    { 0x0072, "Lang1" },
    { 0x0073, "IntlRo" },
    { 0x0076, "F24" },
    { 0x0077, "Lang4" },
    { 0x0078, "Lang3" },
    { 0x0079, "Convert" },
    { 0x007b, "NonConvert" },
    { 0x007d, "IntlYen" },
    { 0x007e, "NumpadComma" },
    { 0xe008, "Undo" },
    { 0xe00a, "Paste" },
    { 0xe010, "MediaTrackPrevious" },
    { 0xe017, "Cut" },
    { 0xe018, "Copy" },
    { 0xe019, "MediaTrackNext" },
    { 0xe01c, "NumpadEnter" },
    { 0xe01d, "ControlRight" },
    { 0xe020, "AudioVolumeMute" },
    { 0xe021, "LaunchApp2" },
    { 0xe022, "MediaPlayPause" },
    { 0xe024, "MediaStop" },
    { 0xe02c, "Eject" },
    { 0xe02e, "AudioVolumeDown" },
    { 0xe030, "AudioVolumeUp" },
    { 0xe032, "BrowserHome" },
    { 0xe035, "NumpadDivide" },
    { 0xe037, "PrintScreen" },
    { 0xe038, "AltRight" },
    { 0xe03b, "Help" },
    { 0xe045, "NumLock" },
    { 0xe047, "Home" },
    { 0xe048, "ArrowUp" },
    { 0xe049, "PageUp" },
    { 0xe04b, "ArrowLeft" },
    { 0xe04d, "ArrowRight" },
    { 0xe04f, "End" },
    { 0xe050, "ArrowDown" },
    { 0xe051, "PageDown" },
    { 0xe052, "Insert" },
    { 0xe053, "Delete" },
    { 0xe05b, "MetaLeft" },
    { 0xe05c, "MetaRight" },
    { 0xe05d, "ContextMenu" },
    { 0xe05e, "Power" },
    { 0xe05f, "Sleep" },
    { 0xe063, "WakeUp" },
    { 0xe065, "BrowserSearch" },
    { 0xe066, "BrowserFavorites" },
    { 0xe067, "BrowserRefresh" },
    { 0xe068, "BrowserStop" },
    { 0xe069, "BrowserForward" },
    { 0xe06a, "BrowserBack" },
    { 0xe06b, "LaunchApp1" },
    { 0xe06c, "LaunchMail" },
    { 0xe06d, "MediaSelect" },
};

const std::unordered_map<uint32_t, qwr::u8string> kVirtualCodeToValue{

    { 0x0009, "Escape" },
    { 0x000a, "Digit1" },
    { 0x000b, "Digit2" },
    { 0x000c, "Digit3" },
    { 0x000d, "Digit4" },
    { 0x000e, "Digit5" },
    { 0x000f, "Digit6" },
    { 0x0010, "Digit7" },
    { 0x0011, "Digit8" },
    { 0x0012, "Digit9" },
    { 0x0013, "Digit0" },
    { 0x0014, "Minus" },
    { 0x0015, "Equal" },
    { 0x0016, "Backspace" },
    { 0x0017, "Tab" },
    { 0x0018, "KeyQ" },
    { 0x0019, "KeyW" },
    { 0x001a, "KeyE" },
    { 0x001b, "KeyR" },
    { 0x001c, "KeyT" },
    { 0x001d, "KeyY" },
    { 0x001e, "KeyU" },
    { 0x001f, "KeyI" },
    { 0x0020, "KeyO" },
    { 0x0021, "KeyP" },
    { 0x0022, "BracketLeft" },
    { 0x0023, "BracketRight" },
    { 0x0024, "Enter" },
    { 0x0025, "ControlLeft" },
    { 0x0026, "KeyA" },
    { 0x0027, "KeyS" },
    { 0x0028, "KeyD" },
    { 0x0029, "KeyF" },
    { 0x002a, "KeyG" },
    { 0x002b, "KeyH" },
    { 0x002c, "KeyJ" },
    { 0x002d, "KeyK" },
    { 0x002e, "KeyL" },
    { 0x002f, "Semicolon" },
    { 0x0030, "Quote" },
    { 0x0031, "Backquote" },
    { 0x0032, "ShiftLeft" },
    { 0x0033, "Backslash" },
    { 0x0034, "KeyZ" },
    { 0x0035, "KeyX" },
    { 0x0036, "KeyC" },
    { 0x0037, "KeyV" },
    { 0x0038, "KeyB" },
    { 0x0039, "KeyN" },
    { 0x003a, "KeyM" },
    { 0x003b, "Comma" },
    { 0x003c, "Period" },
    { 0x003d, "Slash" },
    { 0x003e, "ShiftRight" },
    { 0x003f, "NumpadMultiply" },
    { 0x0040, "AltLeft" },
    { 0x0041, "Space" },
    { 0x0042, "CapsLock" },
    { 0x0043, "F1" },
    { 0x0044, "F2" },
    { 0x0045, "F3" },
    { 0x0046, "F4" },
    { 0x0047, "F5" },
    { 0x0048, "F6" },
    { 0x0049, "F7" },
    { 0x004a, "F8" },
    { 0x004b, "F9" },
    { 0x004c, "F10" },
    { 0x004d, "NumLock" },
    { 0x004e, "ScrollLock" },
    { 0x004f, "Numpad7" },
    { 0x0050, "Numpad8" },
    { 0x0051, "Numpad9" },
    { 0x0052, "NumpadSubtract" },
    { 0x0053, "Numpad4" },
    { 0x0054, "Numpad5" },
    { 0x0055, "Numpad6" },
    { 0x0056, "NumpadAdd" },
    { 0x0057, "Numpad1" },
    { 0x0058, "Numpad2" },
    { 0x0059, "Numpad3" },
    { 0x005a, "Numpad0" },
    { 0x005b, "NumpadDecimal" },
    { 0x005d, "Lang5" },
    { 0x005e, "IntlBackslash" },
    { 0x005f, "F11" },
    { 0x0060, "F12" },
    { 0x0061, "IntlRo" },
    { 0x0062, "Lang3" },
    { 0x0063, "Lang4" },
    { 0x0064, "Convert" },
    { 0x0065, "KanaMode" },
    { 0x0066, "NonConvert" },
    { 0x0068, "NumpadEnter" },
    { 0x0069, "ControlRight" },
    { 0x006a, "NumpadDivide" },
    { 0x006b, "PrintScreen" },
    { 0x006c, "AltRight" },
    { 0x006e, "Home" },
    { 0x006f, "ArrowUp" },
    { 0x0070, "PageUp" },
    { 0x0071, "ArrowLeft" },
    { 0x0072, "ArrowRight" },
    { 0x0073, "End" },
    { 0x0074, "ArrowDown" },
    { 0x0075, "PageDown" },
    { 0x0076, "Insert" },
    { 0x0077, "Delete" },
    { 0x0079, "AudioVolumeMute" },
    { 0x007a, "AudioVolumeDown" },
    { 0x007b, "AudioVolumeUp" },
    { 0x007c, "Power" },
    { 0x007d, "NumpadEqual" },
    { 0x007f, "Pause" },
    { 0x0080, "ShowAllWindows" },
    { 0x0081, "NumpadComma" },
    { 0x0082, "Lang1" },
    { 0x0083, "Lang2" },
    { 0x0084, "IntlYen" },
    { 0x0085, "MetaLeft" },
    { 0x0086, "MetaRight" },
    { 0x0087, "ContextMenu" },
    { 0x0088, "BrowserStop" },
    { 0x0089, "Again" },
    { 0x008b, "Undo" },
    { 0x008c, "Select" },
    { 0x008d, "Copy" },
    { 0x008e, "Open" },
    { 0x008f, "Paste" },
    { 0x0090, "Find" },
    { 0x0091, "Cut" },
    { 0x0092, "Help" },
    { 0x0094, "LaunchApp2" },
    { 0x0096, "Sleep" },
    { 0x0097, "WakeUp" },
    { 0x0098, "LaunchApp1" },
    { 0x00a3, "LaunchMail" },
    { 0x00a4, "BrowserFavorites" },
    { 0x00a6, "BrowserBack" },
    { 0x00a7, "BrowserForward" },
    { 0x00a9, "Eject" },
    { 0x00ab, "MediaTrackNext" },
    { 0x00ac, "MediaPlayPause" },
    { 0x00ad, "MediaTrackPrevious" },
    { 0x00ae, "MediaStop" },
    { 0x00af, "MediaRecord" },
    { 0x00b0, "MediaRewind" },
    { 0x00b3, "MediaSelect" },
    { 0x00b4, "BrowserHome" },
    { 0x00b5, "BrowserRefresh" },
    { 0x00bb, "NumpadParenLeft" },
    { 0x00bc, "NumpadParenRight" },
    { 0x00bf, "F13" },
    { 0x00c0, "F14" },
    { 0x00c1, "F15" },
    { 0x00c2, "F16" },
    { 0x00c3, "F17" },
    { 0x00c4, "F18" },
    { 0x00c5, "F19" },
    { 0x00c6, "F20" },
    { 0x00c7, "F21" },
    { 0x00c8, "F22" },
    { 0x00c9, "F23" },
    { 0x00ca, "F24" },
    { 0x00d1, "MediaPause" },
    { 0x00d7, "MediaPlay" },
    { 0x00d8, "MediaFastForward" },
    { 0x00e1, "BrowserSearch" },
    { 0x00e8, "BrightnessDown" },
    { 0x00e9, "BrightnessUp" },
    { 0x00eb, "DisplayToggleIntExt" },
    { 0x00ef, "MailSend" },
    { 0x00f0, "MailReply" },
    { 0x00f1, "MailForward" },
    { 0x017c, "ZoomToggle" },
    { 0x024b, "LaunchControlPanel" },
    { 0x024c, "SelectTask" },
    { 0x024d, "LaunchScreenSaver" },
    { 0x024f, "LaunchAssistant" },
    { 0x0250, "KeyboardLayoutSelect" },
};

} // namespace

namespace smp::dom
{

qwr::u8string GetDomCode( uint32_t scanCode, uint32_t virtualCode )
{
    auto pValue = qwr::FindAsPointer( kScanCodeToValue, scanCode );
    if ( pValue )
    {
        return *pValue;
    }

    pValue = qwr::FindAsPointer( kVirtualCodeToValue, virtualCode );
    return ( pValue ? *pValue : "Unidentified" );
}

} // namespace smp::dom
